#!/bin/bash

PARENT_DIR="$(dirname "$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd -P)")"
source $PARENT_DIR/parameters

if [[ "$2" != "-f" ]]; then
while true; do
    read -p "Existing distros under $DISTRO_IMG folder will be removed before downloading new distro. Please backup the existing distro if you want to. Do you want to continue? " yn
    case $yn in
        [Yy]* ) make install; break;;
        [Nn]* ) exit;;
        * ) echo "Please answer yes or no.";;
    esac
done
fi

if [[ $? == 0 || "$1" == "release" ]]; then
	version="$DISTRIBUTION_RELEASE_DOWNLOAD_URL"
elif [ "$1" == "snapshot" ]; then
	version="$DISTROBUTION_SNAPSHOT_DOWNLOAD_URL"
else
	echo "Usage: $0 snapshot|release"
	exit 1
fi

rm -rf "$DISTRO_IMG"

echo "Downloading ODL distro from $version .."
echo "Please wait patiently, it may take a while"
wget -nv -P "$DISTRO_IMG" "$version"
echo "ODL distro downloaded!"
